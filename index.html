<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="images/main1.jpg">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- First section -->

<div class="mainpage container" id="firstSection">
  <div class="images mt-4 p-2 pointer-events-auto">
    <img class="p-1" src="images/main1.jpg" alt="#" onclick="showSecondSection()">
    <img class="p-1" src="images/main2.jpg" alt="#">
    <img class="p-1" src="images/main3.jpg" alt="#">
    <img class="p-1" src="images/main4.jpg" alt="#">
  </div>
</div>

<!-- Second section -->

<div class="container arms grid justify-items-center" id="secondSection">
  <img id="theimages" class="armsImg" src="images/1.gif" alt="#">
  <div id="progress-container">
    <div id="progress-bar"></div>
    <div id="progress-text">0/8</div>
  </div>
  <h1 class="mt-1 text-3xl text-center text-green-500 font-semibold" id="exerciseName">THE ALTERNATING HOOKS</h1>
  <h1 id="timer" class="mt-0 text-2xl text-yellow-600 font-bold">00:00</h1>
  <button id="pauseButton" class="bg-transparent text-1xl mt-0 hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-0 px-3 border border-blue-500 hover:border-transparent rounded" onclick="togglePause()">PAUSE</button>
  
  <div class="buttonprenext space-x-24 mt-3">
    <button id="thePreviousButton" class="border p-1 border-red-500 text-1xl hover:border-transparent hover:bg-blue-200 rounded text-red-700 font-bold">PREVIOUS</button>
    <button id="theNextButton" class="border p-1 border-yellow-600 text-1xl hover:border-transparent hover:bg-blue-200 rounded text-yellow-600 font-bold">NEXT TASK</button>
  </div>
  
</div>

<script src="pages.js"></script>
<script>
  let theimages = document.getElementById('theimages');
  let time = 30;
  let timerInterval;
  let isPaused = false;
  let exerciseName = document.getElementById('exerciseName');
  let nextBtn = document.getElementById('theNextButton');
  let PreviousButton = document.getElementById('thePreviousButton');
  let progress = 0;
  let pagecount = 0 ;
  // console.log(pages[pagecount].hasOwnProperty('sets'));

  function updateTimerDisplay() {
    const minutes = Math.floor(time / 60);
    const seconds = time % 60;
    document.getElementById('timer').innerText = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;

    // Announce when time is 15 seconds
    if (time === 18) {
      if(pages[pagecount].hasOwnProperty('sets')){
        clearInterval(timerInterval);
        isPaused = true;
        document.getElementById('pauseButton').innerText = 'RESUME';
        clearInterval(timerInterval);
        speak(`${pages[pagecount].comment} & do it until ${pages[pagecount].sets} times`);
      }else{
        speak(`${pages[pagecount].comment}`);
      }
      
    }

    // Announce countdown from 3 seconds
    if (time <= 3 && time > 0) {
      speak(time.toString());
    }
  }

  function startTimer() {
    timerInterval = setInterval(function () {
      time--;
      updateTimerDisplay();
      if (time === 0) {
        clearInterval(timerInterval);
        const audio = new Audio('audio/bell audio.m4a'); // Replace 'audio1.mp3' with your audio file path
        audio.play();
        nextBtn.onclick();
        time = parseInt(`${pages[pagecount].time}`);
      }
    }, 1000);
  }

  function togglePause() {
    if (time > 0) {
      if (isPaused) {
        isPaused = false;
        document.getElementById('pauseButton').innerText = 'PAUSE';
        startTimer();
      } else {
        isPaused = true;
        document.getElementById('pauseButton').innerText = 'RESUME';
        clearInterval(timerInterval);
      }
    }
  };

  function showSecondSection() {
  document.getElementById('firstSection').style.display = 'none';
  document.getElementById('secondSection').style.visibility = 'visible';
  speak(`start. 30 second. ${pages[pagecount].name}`);
  startTimer();
}

  function speak(text) {
    const speechSynthesis = window.speechSynthesis;
    const speechUtterance = new SpeechSynthesisUtterance(text);
    speechSynthesis.speak(speechUtterance);
  };












  nextBtn.onclick = ()=> {
    if(pagecount < pages.length - 1){
      clearInterval(timerInterval);
      pagecount++;
      theimages.src = pages[pagecount].image;
      exerciseName.innerHTML = pages[pagecount].name;
      time = pages[pagecount].time;
      startTimer();

      speak(`THE NEXT. ${pages[pagecount].name}`);
      const audio = new Audio('audio/bell audio.m4a');
        audio.play();
        increaseProgress();
    }
    else{
        clearInterval(timerInterval);
        pagecount = 0 ;
        progress = 0;
        time = 30;
        theimages.src = pages[pagecount].image;
        exerciseName.innerHTML = pages[pagecount].name;
        time = pages[pagecount].time;
        startTimer();
        updateProgressBar();


        speak(`THE NEXT. ${pages[pagecount].name}`);
      const audio = new Audio('audio/bell audio.m4a');
        audio.play();
    }
}



PreviousButton.onclick = ()=> {
if(pagecount > 0){
      pagecount--;
      theimages.src = pages[pagecount].image;
      exerciseName.innerHTML = pages[pagecount].name;
      clearInterval(timerInterval);
      time = pages[pagecount].time;
      startTimer();
      speak(`THE NEXT. ${pages[pagecount].name}`);
      const audio = new Audio('audio/bell audio.m4a');
        audio.play();
        decreaseProgress();

        console.log(pagecount);
      }
  else{
        pagecount = pages.length;
        progress = pages.length;
        updateProgressBar();
        theimages.src = pages[pagecount].image;
        exerciseName.innerHTML = pages[pagecount].name;
        speak(`THE NEXT. ${pages[pagecount].name}`);
      const audio = new Audio('audio/bell audio.m4a');
        audio.play(); 
      }
}









  const maxProgress = pages.length;
  const progressBar = document.getElementById('progress-bar');
  const progressText = document.getElementById('progress-text');
  progressText.innerHTML = maxProgress;
  console.log(pages.length);

  function increaseProgress() {
    if (progress < maxProgress) {
      progress++;
      updateProgressBar();
    }
  }
  function decreaseProgress(){
  if(progress > 0){
    progress--;
    updateProgressBar();
  }
}

  function updateProgressBar() {
    const percentage = (progress / maxProgress) * 100;
    progressBar.style.width = percentage + '%';
    progressText.textContent = `${progress}/${maxProgress}`;
  }





</script>

</body>
</html>
